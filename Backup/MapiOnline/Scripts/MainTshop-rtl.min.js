function SignUp() { { $("#Frm_SignUp").attr("action", "/Home/register"); $("#Frm_SignUp").ajaxForm({ data: { returnUrl: window.location.href }, success: function (e) { location.reload(true) }, complete: function (e) { } }) } } function AddToShoppingCart(e, t, n, r, i) { if (t == "") return alert("تعداد را انتخاب کنید"); var s = { barcodeId: e, count: t, sizeId: n, colorId: r }; $.ajax({ type: "POST", url: "/Shopping/AddToShoppingCart", contentType: "application/json; charset=utf-8", data: JSON.stringify(s), success: function (t) { if (t.hascolorsize) { window.location = "../Home/ProductDetails?productId=" + e + "&technicalInfo=general" } else if (t.totalQuantity * 1 > 0) { var s = $("#shoppingCart"); var o = ""; if ((r == null || r.length == 0) && (n == null || n.length == 0)) o = i.parents("[name=proBox]").find("#img" + e).find(".img-responsive"); else o = i.parents("[name=proBox]").find(".sp-large").find(".img-responsive"); if (o.length > 0) { var u = o.clone().offset({ top: o.offset().top, left: o.offset().left }).css({ opacity: "0.5", position: "absolute", height: "150px", width: "150px", "z-index": "100" }).appendTo($("body")).animate({ top: s.offset().top + 140, left: s.offset().left + 140, width: 75, height: 75 }, 1e3, "easeInOutExpo"); setTimeout(function () { s.effect("shake", { times: 2 }, 200) }, 1500); u.animate({ width: 0, height: 0 }, function () { $(this).detach() }) } ShowShoppingCartSummery() } else alert("این تعداد از کالای انتخاب شده موجود نمی باشد.") }, error: function (e) { alert(e.responseText) } }) } function DeleteShoppingDetail(e) { var t = { shopdetailId: e }; $.ajax({ type: "POST", url: "/Shopping/DeleteShoppingCartDetail", contentType: "application/json; charset=utf-8", data: JSON.stringify(t), success: function (t) { if (t.isdone == true) { if (t.cartDeleted) window.location = "../Home/Index"; else { $("#" + e).parents("tr").remove(); SetTotalQuantity() } } else alert(t.msg) }, error: function (e) { alert(e.responseText) } }) } function SetTotalQuantity(e) { $.ajax({ type: "POST", url: "/Shopping/GetTotalQuantity", contentType: "application/json; charset=utf-8", success: function (t) { if (e != undefined && e != null) e.find("#totalItemAmount").html(e.find("#itemprice").html() * 1 * e.find("[name=quanitySniper]").val() * 1); $("[id=totalAmount]").html(Math.abs(t.totalAmount)); $("[id=itemCatrQuantity]").html(t.quantity); $("[id=total-price]").html(Math.abs(t.finalAmount)); $("[id=sendExpense]").html(Math.abs(t.deliveryExpense)); $("[id=orderDiscount]").html(Math.abs(t.discount)) }, error: function (e) { alert("خطا در ذخیره تعداد کالا، لطفاً دوباره تلاش کنید.") } }) } function LoadShoppingCart() { $(".glyphicon-trash").unbind().click(function () { DeleteShoppingDetail($(this).parents("td").attr("id")); $($(this)).parents("tr").remove() }); $("input[name='quanitySniper']").unbind().change(function () { var e = $(this).parents("tr"); checkQuantity(e) }); SetTotalQuantity() } function checkQuantity(e) { var t = { shopdetailId: e.attr("id"), quantity: e.find("[name=quanitySniper]").val(), colorId: null, sizeId: null }; $.ajax({ type: "POST", url: "/Shopping/EditShoppingCartDetail", contentType: "application/json; charset=utf-8", data: JSON.stringify(t), success: function (t) { if (t.isdone == true) { SetTotalQuantity(e) } else alert(t.msg) }, error: function (e) { alert(e.responseText) } }) } function ShowShoppingCartSummery() { $.ajax({ type: "POST", url: "/Shopping/ShoppingCartSummary", success: function (e) { $("[id=cartBody]").html(""); if (e.isdone) { $("#SubtotalAmount").html(e.totalAmount); $("[id=cart-total]").html("(" + e.totalAmount + ")"); if (e.details.length > 0) { for (var t = 0; t < e.details.length; t++) { var n = e.details[t]; var r = '<tr class="miniCartProduct" id="tr"' + n.Barcode + ">" + '<td style="width:20%;" class="miniCartProductThumb">' + "<div>" + '<a href="../Home/ProductDetails?productId=' + n.BarcodeId + '">' + "<img src='../Data/" + (n.ApplicationName == "/" ? "" : n.ApplicationName) + "Photos/" + n.Barcode + "/tiny_1.jpg' alt='" + n.Name + "' title='" + n.Name + "' >" + " </a>" + "</div>" + " </td>" + ' <td style="width:39%;">' + '<div class="miniCartDescription">' + " <h4>" + '  <a href="product-details.html">' + n.Name + " </a>" + " </h4>" + '<span class="size">' + ((n.Size != null && n.Size != "" ? n.Size : "") + (n.Color != null && n.Color != "" ? (n.Size != null && n.Size ? " / " : "") + n.Color : "")) + " </span>" + ' <div class="price">' + ' <span class="digit">' + n.Price + "  </span>" + " </div>" + "</div>" + "</td>" + '<td style="width:7%;" class="miniCartQuantity">' + " <span>" + n.Quantity + "عدد </span>" + '<td style="width:4%;" class="miniCartQuantity"><span></span></td>' + " </td>" + ' <td style="width:15%;" class="miniCartSubtotal">' + ' <span class="digit">' + n.Quantity * n.Price + " </span>" + " </td>" + '<td  class="delete" name="delete" style="width:5%; " id="' + n.ShoppingCartDetailsId + '">' + "  <a> x </a>" + "</td>" + " </tr>"; $("[id=cartBody]").append(r) } $("#shopcart").trigger("mouseover"); $("#shopcart").trigger("mouseenter"); $("#shopcart").trigger("hover") } else { $("#shoppingCartDetails").append("سبد خرید خالی است."); $(".linkShopBag").addClass("hidden") } } else { $("#shoppingCartDetails").append(e.msg); $(".linkShopBag").addClass("hidden") } $("#shoppingCartSumm").removeClass("hidden") }, dataType: "json" }) } $(document).ajaxStart(function () { loadingStart() }); $(document).ajaxStop(function () { loadingEnd() }); $(document).ready(function () { $("#btn_SignUp").off().on("click", function () { SignUp() }); ShowShoppingCartSummery(); $("#Frm_Tshop").ajaxForm({ success: function (e) { if (e.isdone) location.reload(true); else $("#logonResult").html(e.msg) }, complete: function (e) { } }); $("#subscribeForm").ajaxForm({ success: function (e) { alert(e.msg) }, complete: function (e) { } }) }); $(document).ajaxStop(function () { loadingEnd(); $("[name=delete]").unbind().click(function () { var e = $(this).attr("id"); DeleteShoppingDetail(e) }); $("table").find(".digit").digits() }); $(document).ready(function () { }); $(document).ready(function () { $(".orderStep a").unbind().click(function (e) { if ($(this).attr("step") >= $(".orderStep .active > a").attr("step")) e.preventDefault() }); if ($("#hdMenuId").val() != undefined) { $("#menu" + $("#hdMenuId").val()).addClass("active") } })